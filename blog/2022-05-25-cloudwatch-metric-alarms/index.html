<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet href=/css/vendor/custom.css><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.2efed5cdb92a90967e9b60d3d4adb7842678183ab3cbde086e42b1078c45aa1d0e86a3afbe9ccd468a046d1daef8eeb26717aa2664302bf271fda5534acaa030.css integrity="sha512-Lv7VzbkqkJZ+m2DT1K23hCZ4GDqzy94IbkKxB4xFqh0OhqOvvpzNRooEbR2u+O6yZxeqJmQwK/Jx/aVTSsqgMA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Monitor your failing Lambdas with CloudWatch and LocalStack - LocalStack</title><meta name=description content="LocalStack now supports CloudWatch metric alarms! In this article, you will learn how to configure and test a simple AWS CloudWatch metric alarm with LocalStack, to get notified on infrastructure failures."><link rel=canonical href=/blog/2022-05-25-cloudwatch-metric-alarms/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/monitoring-failing-lambdas-cloudwatch-localstack-banner.png"><meta name=twitter:title content="Monitor your failing Lambdas with CloudWatch and LocalStack"><meta name=twitter:description content="LocalStack now supports CloudWatch metric alarms! In this article, you will learn how to configure and test a simple AWS CloudWatch metric alarm with LocalStack, to get notified on infrastructure failures."><meta name=twitter:site content="@localstack"><meta name=twitter:creator content="@localstack"><meta property="og:title" content="Monitor your failing Lambdas with CloudWatch and LocalStack"><meta property="og:description" content="LocalStack now supports CloudWatch metric alarms! In this article, you will learn how to configure and test a simple AWS CloudWatch metric alarm with LocalStack, to get notified on infrastructure failures."><meta property="og:type" content="article"><meta property="og:url" content="/blog/2022-05-25-cloudwatch-metric-alarms/"><meta property="og:image" content="/blog/2022-05-25-cloudwatch-metric-alarms/monitoring-failing-lambdas-cloudwatch-localstack-banner.png"><meta property="article:published_time" content="2022-05-25T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-25T00:00:00+00:00"><meta property="og:site_name" content="LocalStack"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"\/blog\/2022-05-25-cloudwatch-metric-alarms\/"},"headline":"Monitor your failing Lambdas with CloudWatch and LocalStack","image":["/blog/2022-05-25-cloudwatch-metric-alarms/monitoring-failing-lambdas-cloudwatch-localstack-banner.png"],"datePublished":"2022-05-25T00:00:00CET","dateModified":"2022-05-25T00:00:00CET","author":{"@type":"Organization","name":"LocalStack"},"publisher":{"@type":"Organization","name":"LocalStack","logo":{"@type":"ImageObject","url":"\/\/images\/og-preview-image.png"}},"description":"LocalStack now supports CloudWatch metric alarms! In this article, you will learn how to configure and test a simple AWS CloudWatch metric alarm with LocalStack, to get notified on infrastructure failures."}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/localstack.cloud\/"},{"@type":"ListItem","position":3,"name":"Blog","item":"https:\/\/localstack.cloud\/\/blog\/"},{"@type":"ListItem","position":4,"name":"2022 05 25 Cloudwatch Metric Alarms","item":"https:\/\/localstack.cloud\/\/blog\/2022-05-25-cloudwatch-metric-alarms\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#6b7cf5><link rel=manifest href=/site.webmanifest><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-101988473-1','auto'),ga('send','pageview')</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-QRFTZPWGB7"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QRFTZPWGB7')</script><script defer src=https://unpkg.com/@tinybirdco/flock.js data-host=https://api.tinybird.co data-token=p.eyJ1IjogIjAwZDRjYzRjLTg4N2UtNGNmZS05YzY4LTJjNzMyNjE5ODdjMCIsICJpZCI6ICI2YzRhMDViNi1iZjVlLTRkY2QtODNlZS1jMmFjYjg5ZjQ1NzAifQ.EPdBzyAb28wUbtZacobblsMi42IwTd7d2amppDfw-jE></script><script type=text/javascript id=hs-script-loader async defer src=//js-eu1.hs-scripts.com/26596507.js></script><script type=text/javascript src=//js-eu1.hsforms.net/forms/embed/v2.js></script><script>function toggleTag(b){const c='tag-'+b;if(c!=='tag-all'){const a=document.getElementsByClassName('tag-all');for(let b=0;b<a.length;b++){const c=a[b];c.classList.add('d-none')}}const d=document.getElementsByClassName(c);for(let a=0;a<d.length;a++){const b=d[a];b.classList.remove('d-none')}const e=document.getElementsByClassName('filterButton');for(let a=0;a<e.length;a++){const b=e[a];b.classList.remove('bg-purple'),b.classList.remove('btn-primary'),b.classList.add('btn-outline-primary')}const f=b+"FilterButton",a=document.getElementById(f);a.classList.add('bg-purple'),a.classList.add('btn-primary'),a.classList.remove('btn-outline-primary')}</script></head><body class="blog single"><header class="navbar fixed-top navbar-expand-lg navbar-light pb-sm-0 bg-transparent" id=navbarGrad><div class="container pb-0 pb-sm-3"><div class="d-flex justify-content-lg-between w-100 flex-wrap flex-lg-nowrap"><label class="menu-icon order-0 d-lg-none" for=menu-btn><span class=navicon></span></label><input class="menu-btn order-0" type=checkbox id=menu-btn>
<a class="navbar-brand order-1 order-md-0" href=/><img src=/images/header-logo-new.svg height=43px alt=Logo style=margin-bottom:-10px></a><div class="flex-grow-1 order-2 d-lg-none"></div><ul class="navbar-nav social-nav d-none d-sm-flex order-3 order-lg-4"><li class=nav-item><a class="nav-link social-hover" target=_blank href=https://twitter.com/localstack><svg width="25" height="26" viewBox="0 0 25 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M25 13.25c0 6.9036-5.5964 12.5-12.5 12.5C5.59644 25.75.0 20.1536.0 13.25.0 6.34644 5.59644.75 12.5.75 19.4036.75 25 6.34644 25 13.25zm-6.56-3.0468C19.0443 10.1315 19.6205 9.97084 20.1562 9.73331 19.7558 10.3325 19.2493 10.8586 18.6651 11.2797 18.6709 11.4076 18.6738 11.5366 18.6738 11.6661c0 3.9487-3.0055 8.5014-8.5012 8.5014C8.48534 20.1675 6.91443 19.6731 5.59285 18.825 5.82615 18.8528 6.06457 18.8669 6.30522 18.8669 7.70545 18.8669 8.9936 18.3894 10.0164 17.5879 8.70861 17.5636 7.6054 16.6997 7.22527 15.5129 7.40754 15.5477 7.59449 15.5662 7.78745 15.5662 8.05952 15.5662 8.32401 15.5299 8.57447 15.4612c-1.36658-.2743-2.39692-1.4817-2.39692-2.9294C6.17755 12.5193 6.17755 12.5066 6.17777 12.4939 6.58041 12.7183 7.04144 12.8526 7.53098 12.868 6.7297 12.3323 6.20183 11.4174 6.20183 10.3811c0-.547520000000001.14751-1.06113.40465-1.50232C8.08024 10.687 10.282 11.8764 12.7651 12.001 12.7139 11.7822 12.6874 11.5542 12.6874 11.32c0-1.64975 1.338-2.98781 2.9878-2.98781.8599.0 1.6364.36276 2.1815.94322C18.5369 9.14149 19.1767 8.89304 19.754 8.55056 19.5305 9.24867 19.057 9.83358 18.44 10.2032z" fill="rgba(255, 255, 255, 0.7)"/></svg><span class=visually-hidden>Twitter</span></a></li><li class=nav-item><a class="nav-link social-hover" target=_blank href=https://github.com/localstack><svg width="25" height="26" viewBox="0 0 25 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.4984.75C5.59688.75.0 6.4882.0 13.5668c0 5.6616 3.58125 10.4647 8.55 12.161C9.175 25.8459 9.40312 25.4501 9.40312 25.1102 9.40312 24.8054 9.39219 23.9996 9.38594 22.9305 5.90938 23.7044 5.175 21.2119 5.175 21.2119c-.56719-1.4808-1.3875-1.875-1.3875-1.875C2.65156 18.5423 3.87187 18.5582 3.87187 18.5582 5.12656 18.6492 5.78594 19.8795 5.78594 19.8795c1.11562 1.9579 2.92656 1.393 3.63906 1.0643C9.5375 20.1156 9.86094 19.5507 10.2188 19.23 7.44375 18.9061 4.525 17.8066 4.525 12.8966c0-1.3994.4875-2.5436 1.2875-3.44036C5.68281 9.13231 5.25469 7.8286 5.93438 6.06534c0 0 1.05-.34468 3.43749 1.31327C10.3688 7.09457 11.4375 6.95256 12.5016 6.94777 13.5625 6.95415 14.6328 7.09457 15.6312 7.38021c2.386-1.65795 3.4344-1.31328 3.4344-1.31328.6813 1.76487.2531 3.06697.125 3.3909C19.9922 10.3546 20.475 11.4988 20.475 12.8982c0 4.9228-2.9219 6.0063-5.7063 6.3238C15.2172 19.6178 15.6172 20.3997 15.6172 21.5949 15.6172 23.3087 15.6016 24.6906 15.6016 25.1102 15.6016 25.4533 15.8266 25.8522 16.4609 25.7262 21.4219 24.0283 25 19.2268 25 13.5668 25 6.4882 19.4031.75 12.4984.75z" fill="rgba(255, 255, 255, 0.7)"/></svg><span class=visually-hidden>GitHub</span></a></li><li class=nav-item><a class="btn btn-primary btn-tertiary" type=link href=https://app.localstack.cloud><i class="bi bi-person"></i> SIGN UP</a></li></ul><div class="collapse navbar-collapse order-4 order-lg-3 flex-grow-0" id=collapse-content><ul class="navbar-nav main-nav me-auto mt-4 mt-sm-0 gap-xl-4 d-flex justify-content-between flex-column flex-sm-row"><li class="nav-item ms-0 dropdown"><a class="nav-link dropdown-toggle" href=# id=productsDropdown data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>SOLUTIONS</a><div class=dropdown-menu aria-labelledby=productsDropdown><a class=dropdown-item href=/solutions/cloud-emulation>CLOUD EMULATION</a>
<a class=dropdown-item href=/solutions/team-collaboration>TEAM COLLABORATION</a>
<a class=dropdown-item href=/solutions/enterprise-integration>ENTERPRISE INTEGRATION</a>
<a class=dropdown-item href=/solutions/ecosystem>ECOSYSTEM</a></div></li><li class="nav-item ms-0"><a class=nav-link style=white-space:nowrap href=/pricing/>PRICING</a></li><li class="nav-item ms-0 dropdown"><a class="nav-link dropdown-toggle" href=# id=productsDropdown data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>COMPANY</a><div class=dropdown-menu aria-labelledby=productsDropdown><a class=dropdown-item href=/company>ABOUT US</a>
<a class=dropdown-item href=/careers>CAREERS</a></div></li><li class="nav-item ms-0 dropdown"><a class="nav-link dropdown-toggle" href=# id=productsDropdown data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>COMMUNITY</a><div class=dropdown-menu aria-labelledby=productsDropdown><a class=dropdown-item href=/community/stay-informed>STAY INFORMED</a>
<a class=dropdown-item href=/community/get-involved>GET INVOLVED</a></div></li><li class="nav-item ms-0 active"><a class=nav-link style=white-space:nowrap href=/blog/>BLOG</a></li><li class="nav-item ms-0 dropdown"><a class="nav-link dropdown-toggle" href=# id=productsDropdown data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>DOCS</a><div class=dropdown-menu aria-labelledby=productsDropdown><a class=dropdown-item href=https://docs.localstack.cloud>DOCUMENTATION</a>
<a class=dropdown-item href=/faq>FAQ</a></div></li><li class="nav-item d-flex d-sm-none justify-content-between"><div class="d-flex gap-4"><a class=nav-link target=_blank href=https://twitter.com/localstack><svg width="25" height="26" viewBox="0 0 25 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M25 13.25c0 6.9036-5.5964 12.5-12.5 12.5C5.59644 25.75.0 20.1536.0 13.25.0 6.34644 5.59644.75 12.5.75 19.4036.75 25 6.34644 25 13.25zm-6.56-3.0468C19.0443 10.1315 19.6205 9.97084 20.1562 9.73331 19.7558 10.3325 19.2493 10.8586 18.6651 11.2797 18.6709 11.4076 18.6738 11.5366 18.6738 11.6661c0 3.9487-3.0055 8.5014-8.5012 8.5014C8.48534 20.1675 6.91443 19.6731 5.59285 18.825 5.82615 18.8528 6.06457 18.8669 6.30522 18.8669 7.70545 18.8669 8.9936 18.3894 10.0164 17.5879 8.70861 17.5636 7.6054 16.6997 7.22527 15.5129 7.40754 15.5477 7.59449 15.5662 7.78745 15.5662 8.05952 15.5662 8.32401 15.5299 8.57447 15.4612c-1.36658-.2743-2.39692-1.4817-2.39692-2.9294C6.17755 12.5193 6.17755 12.5066 6.17777 12.4939 6.58041 12.7183 7.04144 12.8526 7.53098 12.868 6.7297 12.3323 6.20183 11.4174 6.20183 10.3811c0-.547520000000001.14751-1.06113.40465-1.50232C8.08024 10.687 10.282 11.8764 12.7651 12.001 12.7139 11.7822 12.6874 11.5542 12.6874 11.32c0-1.64975 1.338-2.98781 2.9878-2.98781.8599.0 1.6364.36276 2.1815.94322C18.5369 9.14149 19.1767 8.89304 19.754 8.55056 19.5305 9.24867 19.057 9.83358 18.44 10.2032z" fill="rgba(255, 255, 255, 0.7)"/></svg><span class=visually-hidden>Twitter</span></a>
<a class=nav-link target=_blank href=https://github.com/localstack><svg width="25" height="26" viewBox="0 0 25 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.4984.75C5.59688.75.0 6.4882.0 13.5668c0 5.6616 3.58125 10.4647 8.55 12.161C9.175 25.8459 9.40312 25.4501 9.40312 25.1102 9.40312 24.8054 9.39219 23.9996 9.38594 22.9305 5.90938 23.7044 5.175 21.2119 5.175 21.2119c-.56719-1.4808-1.3875-1.875-1.3875-1.875C2.65156 18.5423 3.87187 18.5582 3.87187 18.5582 5.12656 18.6492 5.78594 19.8795 5.78594 19.8795c1.11562 1.9579 2.92656 1.393 3.63906 1.0643C9.5375 20.1156 9.86094 19.5507 10.2188 19.23 7.44375 18.9061 4.525 17.8066 4.525 12.8966c0-1.3994.4875-2.5436 1.2875-3.44036C5.68281 9.13231 5.25469 7.8286 5.93438 6.06534c0 0 1.05-.34468 3.43749 1.31327C10.3688 7.09457 11.4375 6.95256 12.5016 6.94777 13.5625 6.95415 14.6328 7.09457 15.6312 7.38021c2.386-1.65795 3.4344-1.31328 3.4344-1.31328.6813 1.76487.2531 3.06697.125 3.3909C19.9922 10.3546 20.475 11.4988 20.475 12.8982c0 4.9228-2.9219 6.0063-5.7063 6.3238C15.2172 19.6178 15.6172 20.3997 15.6172 21.5949 15.6172 23.3087 15.6016 24.6906 15.6016 25.1102 15.6016 25.4533 15.8266 25.8522 16.4609 25.7262 21.4219 24.0283 25 19.2268 25 13.5668 25 6.4882 19.4031.75 12.4984.75z" fill="rgba(255, 255, 255, 0.7)"/></svg><span class=visually-hidden>GitHub</span></a></div><a class="btn btn-primary btn-tertiary" type=link href=https://app.localstack.cloud/sign-up><i class="bi bi-person"></i> SIGN UP</a></li><li class="nav-item ms-2 d-flex d-sm-none"></li></ul></div></div></div></header><script>const myNav=document.getElementById('navbarGrad'),collapseContent=document.getElementById('collapse-content'),sm=window.matchMedia('(min-width: 576px)').matches;if(window.onscroll=function(){window.scrollY>=25?(myNav.classList.add("navbar-visible"),myNav.classList.remove("bg-transparent")):(getComputedStyle(collapseContent).display==='none'||sm)&&(myNav.classList.add("bg-transparent"),myNav.classList.remove("navbar-visible"))},!sm){const a=document.getElementById('menu-btn');a.onclick=function(){myNav.classList.contains('bg-transparent')?(myNav.classList.add("navbar-visible"),myNav.classList.remove("bg-transparent")):window.scrollY===0&&(myNav.classList.add("bg-transparent"),myNav.classList.remove("navbar-visible"))}}$(document).ready(function(){$(".dropdown").hover(function(){var a=$(this).children(".dropdown-menu");a.is(":visible")&&a.parent().toggleClass("open")})})</script><style>.social-hover:hover svg path{fill:#fff}.dropdown:hover .dropdown-menu{display:block}.dropdown-menu{margin-top:.125rem}</style><section class="section section-sm bg-gradient-dark"><div class="position-absolute w-100 section pb-7 pt-7 d-none d-md-block"><div class=container><div class="row justify-content-center align-items-center"><div class=col-2><img class=w-100 style=transform:scale(2);opacity:.65 src=/images/heroes/blog.svg></div><div class=col-2></div><div class=col-2></div><div class=col-2><img class=w-100 style=transform:rotate(35deg)scale(1.4);opacity:.9 src=/images/heroes/blog.svg></div><div class=col-2><img class=w-100 style=transform:rotate(-45deg)scaleX(-1)scale(1.5);opacity:.75 src=/images/heroes/blog.svg></div></div></div></div><div class="container pb-5 pt-6 pb-md-7 pt-sm-7"><div class="row justify-content-center align-items-center text-white"><h1 class="text-center m-0 pt-lg-5">Monitor your failing Lambdas with CloudWatch and LocalStack</h1></div></div></section><section class="section section-sm mb-6"><div class="container px-lg-8"><div class="row justify-content-center"><div class=col-12><article><div class=blog-header><div class="d-flex align-items-center flex-wrap card-footer-text"><p class=mb-0><img src=/images/common/clock.svg>
7&nbsp;MIN READ&nbsp;&#8212;&nbsp;
posted May 25, 2022 by <a class="stretched-link position-relative">Stefanie</a></p><p></div></div><p class=lead>LocalStack now supports CloudWatch metric alarms! In this article, you will learn how to configure and test a simple AWS CloudWatch metric alarm with LocalStack, to get notified on infrastructure failures.</p><a href=/blog/2022-05-25-cloudwatch-metric-alarms/monitoring-failing-lambdas-cloudwatch-localstack-banner.png target=_blank><figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_20be6eb41fc13e9fd5023eb2812b9cdb.png data-srcset="https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_a4ff9c2e5be4d416ada5cd447bd5e2b1.png 900w,https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_863f062348679f38bcc92c63d32f7040.png 800w,https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_b9e77b17b28b171d9729db34b8c0d0c3.png 700w,https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_ecac0b69fdcd4dc73959e76ebc8366d8.png 600w,https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_761e993186c80e4bf74476eea284c6fd.png 500w" width=1280 height=720><noscript><img class=img-fluid sizes=100vw srcset="https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_a4ff9c2e5be4d416ada5cd447bd5e2b1.png 900w,https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_863f062348679f38bcc92c63d32f7040.png 800w,https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_b9e77b17b28b171d9729db34b8c0d0c3.png 700w,https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_ecac0b69fdcd4dc73959e76ebc8366d8.png 600w,https://localstack.cloud/blog/2022-05-25-cloudwatch-metric-alarms/_hu0b4264c1de101c493b8288bcab46985b_103441_761e993186c80e4bf74476eea284c6fd.png 500w" src=/blog/2022-05-25-cloudwatch-metric-alarms/monitoring-failing-lambdas-cloudwatch-localstack-banner.png width=1280 height=720></noscript></figure></a><p><a href=https://docs.aws.amazon.com/cloudwatch/index.html>AWS CloudWatch</a> is a service that enables monitoring of your AWS infrastructure by collecting logs and operational metrics of your deployment. An integral part of infrastructure operations is reacting in real-time to anomalous changes in metrics, e.g., spiking disk or CPU usage or failures in your serverless functions. This is where CloudWatch metric alarms and actions come into play, which you can now develop and test using LocalStack!</p><p>LocalStack now supports CloudWatch metric alarms with <code>statistic</code> and <code>comparison-operator</code>. This article will discuss how you can use a CloudWatch metric alarm to get notified automatically when your Lambda function invocations fail. We will set up an email notification using the Simple Email Service (SES) in our example.</p><h2 id=prerequisites>Prerequisites</h2><p>For this tutorial you will need:</p><ul><li><a href=https://localstack.cloud>LocalStack Pro</a>, to send emails via SMTP and SES.</li><li>The <a href=https://docs.localstack.cloud/integrations/aws-cli/#localstack-aws-cli-awslocal>awslocal</a> command line utility</li><li>A mock SMTP server like <a href=https://github.com/rnwood/smtp4dev>smtp4dev</a> or <a href=https://github.com/ChangemakerStudios/Papercut-SMTP>Papercut SMTP</a> to receive the email notifications locally.</li></ul><p>To connect LocalStack with the SMTP server, you need to <a href=https://docs.localstack.cloud/aws/ses/#pro>configure the following SMTP environment variables</a> when starting LocalStack:</p><ul><li><code>SMTP_HOST</code> this should contain the hostname and the port of your mock SMTP server</li><li><code>SMTP_USER</code> optional, if there is user to connect</li><li><code>SMTP_PASS</code> optional</li></ul><p>For example, when using smtp4dev, simply run:</p><pre><code>docker run --rm -it -p 3000:80 -p 2525:25 rnwood/smtp4dev
</code></pre><p>and set <code>SMTP_HOST=localhost:2525</code>.
Navigating to <code>http://localhost:3000</code> will open a UI to access the email notifications.</p><h2 id=cloudwatch-basics>CloudWatch Basics</h2><p>CloudWatch can help you to get a better understanding of how your AWS infrastructure resources behave over time. While some metrics are collected automatically, e.g., the execution of Lambdas, you can also define custom metrics you would like to monitor. To that end, you can use the CloudWatch API <a href=https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudwatch/put-metric-data.html><code>put-metric-data</code></a>.</p><p>Here are some basic commands to get started:</p><pre><code class=language-sh># add new metric data
$ awslocal cloudwatch put-metric-data \
   --namespace test \
   --metric-data '[{&quot;MetricName&quot;: &quot;Orders&quot;, &quot;Value&quot;: 20}]' 

# get information about all collected metrics
$ awslocal cloudwatch list-metrics
{
    &quot;Metrics&quot;: [
        {
            &quot;Namespace&quot;: &quot;test&quot;,
            &quot;MetricName&quot;: &quot;Orders&quot;,
            &quot;Dimensions&quot;: []
        }
    ]
}

# query metric data
$ awslocal cloudwatch get-metric-data \
   --metric-data-queries '[{&quot;Id&quot;: &quot;my-id&quot;,&quot;MetricStat&quot;: {&quot;Metric&quot;: {&quot;Namespace&quot;: &quot;test&quot;,&quot;MetricName&quot;: &quot;Orders&quot;},&quot;Period&quot;: 3600, &quot;Stat&quot;: &quot;Sum&quot; }}]' \
   --start-time 2022-05-04T08:00:00Z \
   --end-time  2022-05-04T19:00:00Z
{
    &quot;MetricDataResults&quot;: [
        {
            &quot;Id&quot;: &quot;my-id&quot;,
            &quot;Label&quot;: &quot;Orders Sum&quot;,
            &quot;Timestamps&quot;: [
                &quot;2022-05-04T09:00:00Z&quot;
            ],
            &quot;Values&quot;: [
                20.0
            ],
            &quot;StatusCode&quot;: &quot;Complete&quot;
        }
    ]
}
</code></pre><p>You can also use our <strong>LocalStack WebApp</strong> and navigate to <a href=https://app.localstack.cloud/resources/monitoring>https://app.localstack.cloud/resources/monitoring</a>. Here you can add metrics (and alarms) as well, supported by a nice UI, which already gives you configurable parameters.</p><p>In order to create an alarm, you need to define what kind of metrics the alarm should evaluate.
LocalStack supports metric alarms with simple statics. This typically includes:</p><ul><li><strong>metric-name</strong></li><li><strong>namespace</strong></li><li><strong>threshold</strong> - a double value</li><li><strong>comparison-operator</strong> - e.g. <em>GreaterThanThreshold</em>, <em>LessThanThreshold</em>, <em>GreaterThanOrEqualToThreshold</em>, <em>LessThanOrEqualToThreshold</em></li><li><strong>statistic</strong> - e.g. <em>SampleCount</em>, <em>Average</em>, <em>Sum</em>, <em>Minimum</em>, <em>Maximum</em></li><li><strong>period</strong> - the interval in seconds used to calculate the metric</li><li><strong>evaluation-periods</strong> - defines the number of periods that will be evaluated to check the threshold</li><li><strong>treat-missing-data</strong> - defines how missing data points should be evaluated: <em>missing</em>, <em>ignore</em>, <em>notBreaching</em>, <em>breaching</em></li></ul><p>For a deeper understanding of alarm evaluation, we advice to consult the official <a href=https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html#alarm-evaluation>AWS docs</a>.</p><p>Even though LocalStack&rsquo;s implementation of CloudWatch is not yet feature complete, you can already cover a range of use-cases. Next, we look into how we can make use of CloudWatch alarms with Lambdas.</p><h2 id=setup-a-lambda-function>Setup a Lambda Function</h2><p>For simplicity, we will create a Lambda that will always fail. This will make it easier to demonstrate the alarm&rsquo;s functionality. Suppose you are interested in further learning about Lambdas. In that case, you can check our previous blog post on <a href=https://localstack.cloud/blog/2022-03-07-hot-swapping-python-lambda-functions-using-localstack/>Hot Swapping Python Lambda Functions using LocalStack</a>, which also gives a solid introduction to Lambdas.</p><pre><code class=language-py># failing-lambda.py
import json

def lambda_handler(event, context): 
    raise Exception('fail on purpose')
</code></pre><p>Next we zip <code>failing-lambda.py</code> and create our lambda-function:</p><pre><code class=language-sh>$ zip failing-lambda.zip failing-lambda.py

$ awslocal lambda create-function \
    --function-name my-failing-lambda \
    --zip-file fileb://failing-lambda.zip \
    --handler failing-lambda.lambda_handler \
    --runtime python3.8 \
    --role my-role
</code></pre><p>When this lambda is invoked, it will fail immediately. Also the metrics are collected automatically, so we can now define a metric alarm that will notify us, once this happens.</p><h2 id=metric-alarms>Metric alarms</h2><p>Now let&rsquo;s think about when we want to trigger the alarm. We need to define which metrics we are interested in, and how thresholds should be calculated.
If you invoke the lambda once, and run <code>list-metrics</code> you will see that we already have some metrics here:</p><pre><code class=language-sh>$ awslocal cloudwatch list-metrics
{
    &quot;Metrics&quot;: [
        {
            &quot;Namespace&quot;: &quot;AWS/Lambda&quot;,
            &quot;MetricName&quot;: &quot;Invocations&quot;,
            &quot;Dimensions&quot;: [
                {
                    &quot;Name&quot;: &quot;FunctionName&quot;,
                    &quot;Value&quot;: &quot;my-failing-lambda&quot;
                }
            ]
        },
        {
            &quot;Namespace&quot;: &quot;AWS/Lambda&quot;,
            &quot;MetricName&quot;: &quot;Errors&quot;,
            &quot;Dimensions&quot;: [
                {
                    &quot;Name&quot;: &quot;FunctionName&quot;,
                    &quot;Value&quot;: &quot;my-failing-lambda&quot;
                }
            ]
        }
    ]
}
</code></pre><p>Obviously, there are metrics reported for every invocation of a Lambda - we can see the metric name &ldquo;Invocations&rdquo;.</p><p>Additionally, there is a metric for &ldquo;Errors&rdquo;. This is the one we want to track.
For the alarm, we will need the <code>Namespace</code>, <code>MetricName</code>, and the <code>Dimensions</code>. The latter one will make sure we only consider alarms for the lambda <em>my-failing-lambda</em>.</p><p>Now, we just need to think about reasonable evaluation criteria - what is reasonable will depend a lot on your specific use case.</p><p>Let&rsquo;s say we want to get notified if the lambda fails at least once within the past minute.
Then the <code>evaluation-periods</code> would be 1, and <code>period</code> would be 60.</p><p>For the <code>statistic</code> we use <em>Sum</em> (failing invocation within the last minute will be summed up), and our <code>threshold</code> is 1, with the <code>comparison-operator</code> <em>GreaterThanOrEqualToThreshold</em>.</p><p>In case the lambda was not invoke, we assume everything is fine. So we set <code>treat-missing-data</code> to <em>notBreaching</em>.</p><p>At this time we know how we want to evaluate the metrics. So the only thing left is configuring the action that should be executed, once the alarm changes its state to <em>ALARM</em>.</p><h2 id=alarm-actions>Alarm actions</h2><p>Actions are optional parameters that we can configure for alarms. There is one configuration for every state: <code>alarm-actions</code>, <code>ok-actions</code>, and <code>insufficient-data-actions</code>. We will execute the action once the alarm state changes.</p><p>LocalStack supports SNS Topics as actions. We must create the topic beforehand, and we need to know the topic&rsquo;s ARN for the metric-alarm configuration.</p><p>Before we can use the email feature, we have to do some preparations: We need to verify the email address where you want to send the messages to:</p><pre><code class=language-sh>$ awslocal ses verify-email-identity --email-address stefanie@example.com
</code></pre><p>Next, we can create the SNS topic. Remember: we need this ARN for the alarm configuration.
We also need to create a subscription to this topic, so the that the email will be sent to our address.</p><pre><code class=language-sh>$ awslocal sns create-topic --name my-topic-alarm
{
    &quot;TopicArn&quot;: &quot;arn:aws:sns:us-east-1:000000000000:my-topic-alarm&quot;
}

$ awslocal sns subscribe --topic-arn arn:aws:sns:us-east-1:000000000000:my-topic-alarm --protocol email --notification-endpoint stefanie@example.com

</code></pre><p>Finally, we have everything we need to create the metric-alarm:</p><pre><code class=language-sh>$ awslocal cloudwatch put-metric-alarm \
  --alarm-name my-lambda-alarm \
  --metric-name Errors \
  --namespace AWS/Lambda \
  --dimensions &quot;Name=FunctionName,Value=my-failing-lambda&quot; \
  --threshold 1 \
  --comparison-operator GreaterThanOrEqualToThreshold \
  --evaluation-periods 1 \
  --period 60 \
  --statistic Sum \
  --treat-missing notBreaching \
  --alarm-actions arn:aws:sns:us-east-1:000000000000:my-topic-alarm 

</code></pre><p>If we invoke the Lambda function now, you should get an email notification after some time:</p><pre><code class=language-sh>$ awslocal lambda invoke --function-name my-failing-lambda out.txt
</code></pre><p>The email will contain plain text, and gives you information about the alarm that was triggered:</p><pre><code class=language-sh>Content-Type: text/plain; charset=&quot;us-ascii&quot;
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Subject: SNS-Subscriber-Endpoint
From: LocalStack &lt;admin@localstack.com&gt;
To: stefanie@example.com

{&quot;OldStateValue&quot;: &quot;OK&quot;, &quot;AlarmName&quot;: &quot;my-lambda-alarm&quot;, &quot;AlarmDescription&quot;: &quot;&quot;, &quot;AlarmConfigurationUpdatedTimestamp&quot;: &quot;2022-05-04T13:58:57.297769000Z&quot;, &quot;NewStateValue&quot;: &quot;ALARM&quot;, &quot;NewStateReason&quot;: &quot;Threshold crossed&quot;, &quot;StateChangeTime&quot;: &quot;2022-05-04T13:59:20.438156000Z&quot;, &quot;Region&quot;: &quot;us-east-1&quot;, &quot;AlarmArn&quot;: &quot;arn:aws:cloudwatch:us-east-1:000000000000:alarm:my-lambda-alarm&quot;, &quot;OKActions&quot;: &quot;&quot;, &quot;AlarmActions&quot;: [&quot;arn:aws:sns:us-east-1:000000000000:my-topic-alarm&quot;], &quot;InsufficientDataActions&quot;: &quot;&quot;, &quot;Trigger&quot;: {&quot;MetricName&quot;: &quot;Errors&quot;, &quot;Namespace&quot;: &quot;AWS/Lambda&quot;, &quot;Unit&quot;: &quot;&quot;, &quot;Period&quot;: 60, &quot;EvaluationPeriods&quot;: 1, &quot;ComparisonOperator&quot;: &quot;GreaterThanOrEqualToThreshold&quot;, &quot;Threshold&quot;: 1.0, &quot;TreatMissingData&quot;: &quot;notBreaching&quot;, &quot;EvaluateLowSampleCountPercentile&quot;: &quot;&quot;, &quot;Dimensions&quot;: [{&quot;value&quot;: &quot;my-failing-lambda&quot;, &quot;name&quot;: &quot;FunctionName&quot;}], &quot;StatisticType&quot;: &quot;Statistic&quot;, &quot;Statistic&quot;: &quot;SUM&quot;}}
</code></pre><h2 id=conclusion>Conclusion</h2><p>CloudWatch is an integral part of infrastructure management to monitor and react to operational metrics. Metric alarms are periodically evaluated and make you aware if thresholds of metrics are breached.</p><p>The configured actions automatically trigger once the alarm state changes and can help respond quickly to any anomalies. In our example, we showed how to use email notifications, but this is just one way. You could also use webhooks, SQS queues, or other SNS topic subscribers. Check out the code over our <a href=https://github.com/localstack/localstack-pro-samples/tree/master/cloudwatch-metrics-aws>samples repository</a> and create an issue on <a href=https://github.com/localstack/localstack/issues/new>GitHub</a> or connect with us on <a href=https://localstack.cloud/contact>LocalStack Slack</a> to get help.</p></article></div></div></div></section><section class="section bg-gradient-light"><div class=container><div class="row justify-content-center"><div class="d-flex flex-column gap-4 col-lg-12 text-white"><h2 class="h2 text-center">Stay in the loop</h2><p>We'd love to get in touch with you.
Please subscribe with your email to stay tuned for release notes and product updates.
We promise never to send an excessive amount of emails (we hate spam, too).</p><script>hbspt.forms.create({region:"eu1",portalId:"26596507",formId:"1cc99237-4ce0-4d65-abdf-f87ac2724717"})</script></div></div></div></section><footer class="footer pt-6 bg-gradient-dark"><div class="footer-main pb-5"><div class=container><div class="row justify-content-between"><div class="col-12 col-lg-4"><img style=width:243px src=/images/header-logo-new.svg alt="LocalStack Logo"></div><div class="col-12 col-lg-8 mt-4 mt-lg-0"><div class="row gap-4"><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=/contact>Contact</a></li><li><a class=footer-text href=/pricing>Pricing</a></li><li><a class=footer-text href=/blog>Blog</a></li><li><a class=footer-text href=/careers>Careers</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=https://app.localstack.cloud>App</a></li><li><a class=footer-text href=/community>Community</a></li><li><a class=footer-text href=/faq>FAQ</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=https://github.com/localstack>GitHub</a></li><li><a class=footer-text href=https://hub.docker.com/u/localstack>DockerHub</a></li><li><a class=footer-text href=https://docs.localstack.cloud>Docs</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li class=footer-text>Follow us</li><li class="d-flex gap-3"><a class=footer-text href=https://twitter.com/localstack><span><svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M25 13.25c0 6.9036-5.5964 12.5-12.5 12.5C5.59644 25.75.0 20.1536.0 13.25.0 6.34644 5.59644.75 12.5.75 19.4036.75 25 6.34644 25 13.25zm-6.56-3.0468C19.0443 10.1315 19.6205 9.97084 20.1562 9.73331 19.7558 10.3325 19.2493 10.8586 18.6651 11.2797 18.6709 11.4076 18.6738 11.5366 18.6738 11.6661c0 3.9487-3.0055 8.5014-8.5012 8.5014C8.48534 20.1675 6.91443 19.6731 5.59285 18.825 5.82615 18.8528 6.06457 18.8669 6.30522 18.8669 7.70545 18.8669 8.9936 18.3894 10.0164 17.5879 8.70861 17.5636 7.6054 16.6997 7.22527 15.5129 7.40754 15.5477 7.59449 15.5662 7.78745 15.5662 8.05952 15.5662 8.32401 15.5299 8.57447 15.4612c-1.36658-.2743-2.39692-1.4817-2.39692-2.9294C6.17755 12.5193 6.17755 12.5066 6.17777 12.4939 6.58041 12.7183 7.04144 12.8526 7.53098 12.868 6.7297 12.3323 6.20183 11.4174 6.20183 10.3811c0-.547520000000001.14751-1.06113.40465-1.50232C8.08024 10.687 10.282 11.8764 12.7651 12.001 12.7139 11.7822 12.6874 11.5542 12.6874 11.32c0-1.64975 1.338-2.98781 2.9878-2.98781.8599.0 1.6364.36276 2.1815.94322C18.5369 9.14149 19.1767 8.89304 19.754 8.55056 19.5305 9.24867 19.057 9.83358 18.44 10.2032z" fill="#fff"/></svg></span></a><a class=footer-text href=https://www.linkedin.com/company/localstack-cloud><span><svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 26c7.1797.0 13-5.8203 13-13S20.1797.0 13 0 0 5.8203.0 13 5.8203 26 13 26zM9.35126 10.5024C9.97963 10.5024 10.489 9.993 10.489 9.36463S9.97963 8.22687 9.35126 8.22687 8.2135 8.73626 8.2135 9.36463s.50939 1.13777 1.13776 1.13777zm2.21194.8622v6.3122h1.9599V14.5553C13.5231 13.7316 13.6781 12.9339 14.6993 12.9339c1.0073.0 1.0198.941700000000001 1.0198 1.6734v3.0701H17.68V14.2157C17.68 12.5153 17.3139 11.2086 15.3265 11.2086c-.9542.0-1.5938.5236-1.8554 1.0192H13.4446V11.3646H11.5632zm-3.19382.0H10.3324v6.3122H8.36938V11.3646z" fill="#fff"/></svg></span></a></li></ul></div></div></div></div></div></div><div class=footer-bottom><div class="container mb-2"><hr><div class="row pt-4"><div class=col style=color:#fff;opacity:.5>Copyright &copy; LocalStack</div><div class="col text-end"><ul class=list-inline><li class=list-inline-item><a class=footer-last-text href=/privacy-policy>Privacy policy</a></li><li class=list-inline-item><a class=footer-last-text href=/terms>Terms of Service</a></li><li class=list-inline-item><a class=footer-last-text href=/#>Imprint</a></li></ul></div></div></div></div></footer><script src=/js/bootstrap.min.51b4083a09e54138d5bbe9c42a5f5f71af6e60a417f276d5620cbde3b15eb1a07c9ea17a889bc58074adf9b19641039a77521d3131f039300d2fe29ffa532aa8.js integrity="sha512-UbQIOgnlQTjVu+nEKl9fca9uYKQX8nbVYgy947FesaB8nqF6iJvFgHSt+bGWQQOad1IdMTHwOTANL+Kf+lMqqA==" crossorigin=anonymous defer></script><script src=/js/highlight.min.8cdbefd08ec63ef25f4b2510ae50c13b3d9ed43e25a15ddb55f14c33130e68cf8be3131ccf2d087c49f5f21fe88c2f0e2715a21f936047d0d0b85dc48cb864b9.js integrity="sha512-jNvv0I7GPvJfSyUQrlDBOz2e1D4loV3bVfFMMxMOaM+L4xMczy0IfEn18h/ojC8OJxWiH5NgR9DQuF3EjLhkuQ==" crossorigin=anonymous defer></script><script src=/main.min.8933efb6bcdc37606a11f732d52c6f65d7fc1d082b89d56516f6a1bfb528ee7c40c3430bb80214cdd129ec7d69d4cadd74e693da54a9ba6f08c44771204d4468.js integrity="sha512-iTPvtrzcN2BqEfcy1SxvZdf8HQgridVlFvahv7Uo7nxAw0MLuAIUzdEp7H1p1MrddOaT2lSpum8IxEdxIE1EaA==" crossorigin=anonymous defer></script><script src=/index.min.28297aad85d5f5902201eb4ef84e7012a37d4a34824e2256df80cd91e547bf155df22029e5596951d6f2692dd1fee54c76721b407e5ac526bd33bedc636a87e5.js integrity="sha512-KCl6rYXV9ZAiAetO+E5wEqN9SjSCTiJW34DNkeVHvxVd8iAp5VlpUdbyaS3R/uVMdnIbQH5axSa9M77cY2qH5Q==" crossorigin=anonymous defer></script></body></html>